services:
  # 生产环境 - 静态站点服务
  ai-markdown:
    image: registry.cn-shanghai.aliyuncs.com/reuben_home/ai-markdown:latest
    container_name: ai-markdown
    ports:
      - "8263:80"
    environment:
      - TZ=Asia/Shanghai
    restart: unless-stopped
    networks:
      - ai-network
    labels:
      - "com.centurylinklabs.watchtower.enable=true"
      - "com.ai-markdown.description=AI Markdown VitePress Site"

  # Watchtower - 自动更新容器镜像
  watchtower:
    image: containrrr/watchtower
    container_name: watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - TZ=Asia/Shanghai
      # 检查更新间隔（秒），300秒=5分钟
      - WATCHTOWER_POLL_INTERVAL=300
      # 只更新带 watchtower.enable 标签的容器
      - WATCHTOWER_LABEL_ENABLE=true
      # 更新后立即清理旧镜像
      - WATCHTOWER_CLEANUP=true
    restart: unless-stopped
    networks:
      - ai-network

networks:
  ai-network:
    driver: bridge
